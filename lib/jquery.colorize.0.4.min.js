(function(C){(function(){var c=jQuery.fn.addClass;jQuery.fn.addClass=function(){c.apply(this,arguments);jQuery(this).trigger("cssClassChanged",arguments)};var N=jQuery.fn.removeClass;jQuery.fn.removeClass=function(){N.apply(this,arguments);jQuery(this).trigger("cssClassChanged",arguments)}})();jQuery("*").live("cssClassChanged",function(P,N){var c=C(this),O=c.attr("class");if(N.indexOf("colorize-")!=-1){c.colorize("filter",O)}P.stopPropagation()});String.prototype.startsWith=function(c){var N=new RegExp("^"+c);return N.test(this)};var z={duration:0,opacity:1,},y=["blur","emboss","greyscale","matrix","mosaic","noise","posterize","sepia","sharpen","tint"],v={blurAmount:1,embossAmount:0.2,greyscaleOpacity:1,matrixAmount:0.2,mosaicOpacity:1,mosaicSize:5,noiseAmount:30,noiseType:"mono",posterizeAmount:5,posterizeOpacity:1,sepiaOpacity:1,sharpenAmount:0.2,tintColor:"#FFF",tintOpacity:0.3},q=C("<canvas />").get(0),L=q.getContext("2d");var D={init:function(c){return this.each(function(){var O=C(this),N=O.data("colorize"),P=this.nodeName=="IMG"?this.src:this.style.backgroundImage;if(!N){O.data("colorize",{target:this,imageSource:P})}})},destroy:function(){return this.each(function(){var N=C(this),c=N.data("colorize")})},applyf:function(){},filter:function(N,c){q=C("<canvas />").get(0),L=q.getContext("2d");var O=C.extend({},v,c);return this.each(function(af,P){var ac=C(this),W=ac.data("colorize"),T=q;if(!W){W={target:this,imageSource:this.nodeName=="IMG"?this.src:this.style.backgroundImage};ac.data("colorize",W)}var S=O,R=N||"",ae=null,Y=W.target;if(Y.nodeName=="IMG"){Y.src=W.imageSource}else{Y.style.backgroundImage=W.imageSource}var V=Y;L.width=T.width=V.width;L.height=T.height=V.height;if(V&&L){var ad=[],X=[],ab=h(true),aa=ab,Z=0;C.each(R.split(" "),function(ah,ai){var ag=ai.split("-");if(ag.length>1&&ag[0]=="colorize"&&C.inArray(ag[1],y)!=-1){ad[Z]=ag[1]+(ag[2]?"-"+ag[2]:"")+(ag[3]?"-"+ag[3]:"");X[Z++]={name:ag[1],p0:ag[2]||false,p1:ag[3]||false}}});var U=ad.length>0?ac.data("colorize_"+H(ad.join(" "))):W.imageSource;if(!U){var Q=J(L,V);C.each(X,function(au,aq){if(aq.name=="blur"){Q=A(V,Q,aq.p0?parseFloat(aq.p0):S.blurAmount)}if(aq.name=="emboss"){var ay=[-2,-1,0,-1,1,1,0,1,2];Q=j(V,Q,ay,aq.p0?parseFloat(aq.p0):S.embossAmount)}if(aq.name=="matrix"){var ay=[0.111,0.111,0.111,0.111,0.111,0.111,0.111,0.111,0.111];Q=j(V,Q,ay,aq.p0?parseFloat(aq.p0):S.matrixAmount)}if(aq.name=="sharpen"){var ay=[-1,-1,-1,-1,9,-1,-1,-1,-1];Q=j(V,Q,ay,aq.p0?parseFloat(aq.p0):S.sharpenAmount)}if(aq.name=="tint"){var aj=parseInt(n(aq.p0?aq.p0:S.tintColor),16),ap={r:((aj&16711680)>>16),g:((aj&65280)>>8),b:(aj&255)}}if((aq.name!="blur")&&(aq.name!="emboss")&&(aq.name!="matrix")&&(aq.name!="sharpen")){var an,aD,ax,aw,aC,ao=V.width;switch(aq.name){case"greyscale":an=aq.p0?parseFloat(aq.p0):S.greyscaleOpacity;for(var az=0,ag=Q.data.length;az<ag>>2;az++){var ai=az<<2,ar={r:Q.data[ai],g:Q.data[ai+1],b:Q.data[ai+2]};aD=(ar.r*0.21)+(ar.g*0.71)+(ar.b*0.07);Q.data[ai]=an*aD+(1-an)*ar.r;Q.data[ai+1]=an*aD+(1-an)*ar.g;Q.data[ai+2]=an*aD+(1-an)*ar.b}break;case"mosaic":aw=aq.p1?parseFloat(aq.p1):S.mosaicSize;an=aq.p0?parseFloat(aq.p0):S.mosaicOpacity;for(var az=0,ag=Q.data.length;az<ag>>2;az++){var ai=az<<2,ar={r:Q.data[ai],g:Q.data[ai+1],b:Q.data[ai+2]},ah=ai>>2,ak=Math.floor(ah/ao),aB=ak%aw,al=ah-(ak*ao),av=al%aw;if(aB){ah-=aB*ao}if(av){ah-=av}ah=ah<<2;Q.data[ai]=an*Q.data[ah]+(1-an)*ar.r;Q.data[ai+1]=an*Q.data[ah+1]+(1-an)*ar.g;Q.data[ai+2]=an*Q.data[ah+2]+(1-an)*ar.b}break;case"noise":aC=aq.p1?aq.p1:S.noiseType;ax=aq.p0?parseFloat(aq.p0):S.noiseAmount;aD=F(ax);if((aC=="mono")||(aC=="monochrome")){W=M(W,ai,i(ar.r+aD),i(ar.g+aD),i(ar.b+aD))}else{W=M(W,ai,i(ar.r+F(ax)),i(ar.g+F(ax)),i(ar.b+F(ax)))}break;case"posterize":ax=aq.p0?parseFloat(aq.p0):S.posterizeAmount;an=aq.p1?parseFloat(aq.p1):S.posterizeOpacity;var aA=256/ax,at=255/(ax-1);for(var az=0,ag=Q.data.length;az<ag>>2;az++){var ai=az<<2,ar={r:Q.data[ai],g:Q.data[ai+1],b:Q.data[ai+2]};Q.data[ai]=an*parseInt(at*parseInt(ar.r/aA))+(1-an)*ar.r;Q.data[ai+1]=an*parseInt(at*parseInt(ar.g/aA))+(1-an)*ar.g;Q.data[ai+2]=an*parseInt(at*parseInt(ar.b/aA))+(1-an)*ar.b}break;case"sepia":an=aq.p0?parseFloat(aq.p0):S.sepiaOpacity;for(var az=0,ag=Q.data.length;az<ag>>2;az++){var ai=az<<2,ar={r:Q.data[ai],g:Q.data[ai+1],b:Q.data[ai+2]};Q.data[ai]=an*((ar.r*0.393)+(ar.g*0.769))+(ar.b*0.189)+(1-an)*ar.r;Q.data[ai+1]=an*((ar.r*0.349)+(ar.g*0.686))+(1-an)*ar.g;Q.data[ai+2]=an*((ar.r*0.272)+(ar.g*0.534))+(1-an)*ar.b}break;case"tint":an=aq.p1?parseFloat(aq.p1):S.tintOpacity;for(var az=0,ag=Q.data.length;az<ag>>2;az++){var ai=az<<2,ar={r:Q.data[ai],g:Q.data[ai+1],b:Q.data[ai+2]};Q.data[ai]=an*ap.r+(1-an)*ar.r;Q.data[ai+1]=an*ap.g+(1-an)*ar.g;Q.data[ai+2]=an*ap.b+(1-an)*ar.b}break}}});L.putImageData(Q,0,0);U=T.toDataURL("image/png");ac.data("colorize_"+H(ad.join(" ")),U)}if(P.nodeName=="IMG"){P.src=U}else{P.style.backgroundImage="url("+U+")"}aa=h(true);console.log(aa-ab)}})}};C.fn.colorize=function(c){if(D[c]){return D[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return D.init.apply(this,arguments)}else{C.error("Method "+c+" does not exist on jQuery.colorize")}}};function h(N){var c=new Date().getTime()/1000;var O=parseInt(c);return(N)?c:(Math.round((c-O)*1000)/1000)+" "+O}function l(T,ab,af,W,N,U,S){var ae=W.data,ag,Q,Z,ad,Y,R=af.width;switch(T.name){case"greyscale":Q=T.p0?parseFloat(T.p0):ab.greyscaleOpacity;ag=(U.r*0.21)+(U.g*0.71)+(U.b*0.07);ae[N]=Q*ag+(1-Q)*U.r;ae[N+1]=Q*ag+(1-Q)*U.g;ae[N+2]=Q*ag+(1-Q)*U.b;break;case"mosaic":Y=T.p1?parseFloat(T.p1):ab.mosaicSize;Q=T.p0?parseFloat(T.p0):ab.mosaicOpacity;var c=N>>2,O=Math.floor(c/R),ac=O%Y,P=c-(O*R),X=P%Y;if(ac){c-=ac*R}if(X){c-=X}c=c<<2;ae=M(ae,N,o(Q,ae[c],U.r),o(Q,ae[c+1],U.g),o(Q,ae[c+2],U.b));break;case"noise":ad=T.p1?T.p1:ab.noiseType;Z=T.p0?parseFloat(T.p0):ab.noiseAmount;ag=F(Z);if((ad=="mono")||(ad=="monochrome")){ae=M(ae,N,i(U.r+ag),i(U.g+ag),i(U.b+ag))}else{ae=M(ae,N,i(U.r+F(Z)),i(U.g+F(Z)),i(U.b+F(Z)))}break;case"posterize":Z=T.p0?parseFloat(T.p0):ab.posterizeAmount;Q=T.p1?parseFloat(T.p1):ab.posterizeOpacity;var aa=256/Z,V=255/(Z-1);ae=M(ae,N,o(Q,parseInt(V*parseInt(U.r/aa)),U.r),o(Q,parseInt(V*parseInt(U.g/aa)),U.g),o(Q,parseInt(V*parseInt(U.b/aa)),U.b));break;case"sepia":Q=T.p0?parseFloat(T.p0):ab.sepiaOpacity;ae=M(ae,N,o(Q,(U.r*0.393)+(U.g*0.769)+(U.b*0.189),U.r),o(Q,(U.r*0.349)+(U.g*0.686)+(U.b*0.168),U.g),o(Q,(U.r*0.272)+(U.g*0.534)+(U.b*0.131),U.b));break;case"tint":Q=T.p1?parseFloat(T.p1):ab.tintOpacity;ae=M(ae,N,o(Q,S.r,U.r),o(Q,S.g,U.g),o(Q,S.b,U.b));break}return(W)}function A(ak,ac,U){var ae=ak.width;var ag=ae<<2;var ab=ak.height;if(ac){var aj=ac.data;var ad;if(U<0){U=0}if(U>=2.5){ad=0.98711*U-0.9633}else{if(U>=0.5){ad=3.97156-4.14554*Math.sqrt(1-0.26891*U)}else{ad=2*U*(3.97156-4.14554*Math.sqrt(1-0.26891*0.5))}}var N=ad*ad;var aa=N*ad;var V=1.57825+(2.44413*ad)+(1.4281*N)+(0.422205*aa);var T=((2.44413*ad)+(2.85619*N)+(1.26661*aa))/V;var R=(-((1.4281*N)+(1.26661*aa)))/V;var Q=(0.422205*aa)/V;var W=1-(T+R+Q);for(var ah=0;ah<3;ah++){for(var X=0;X<ab;X++){var S=X*ag+ah;var Z=X*ag+((ae-1)<<2)+ah;var P=aj[S];var ai=P;var af=ai;var O=af;for(;S<=Z;S+=4){P=W*aj[S]+T*ai+R*af+Q*O;aj[S]=P;O=af;af=ai;ai=P}S=X*ag+((ae-1)<<2)+ah;Z=X*ag+ah;P=aj[S];ai=P;af=ai;O=af;for(;S>=Z;S-=4){P=W*aj[S]+T*ai+R*af+Q*O;aj[S]=P;O=af;af=ai;ai=P}}}for(var ah=0;ah<3;ah++){for(var Y=0;Y<ae;Y++){var S=(Y<<2)+ah;var Z=(ab-1)*ag+(Y<<2)+ah;var P=aj[S];var ai=P;var af=ai;var O=af;for(;S<=Z;S+=ag){P=W*aj[S]+T*ai+R*af+Q*O;aj[S]=P;O=af;af=ai;ai=P}S=(ab-1)*ag+(Y<<2)+ah;Z=(Y<<2)+ah;P=aj[S];ai=P;af=ai;O=af;for(;S>=Z;S-=ag){P=W*aj[S]+T*ai+R*af+Q*O;aj[S]=P;O=af;af=ai;ai=P}}}return(ac)}}function j(af,W,Y,Q){var P=document.createElement("canvas");var X=P.getContext("2d");X.width=P.width=af.width;X.height=P.height=af.height;X.drawImage(af,0,0,af.width,af.height);var R=X.getImageData(0,0,L.width,L.height);var ae=W.data,ac=R.data,S=af.width;Y=r(Y);var c=Math.sqrt(Y.length);for(var aa=1;aa<S-1;aa++){for(var Z=1;Z<af.height-1;Z++){var N=sumG=sumB=0;for(var ab=0;ab<c;ab++){for(var T=0;T<c;T++){var V=I(aa+ab-1,Z+T-1,S)<<2;var ad={r:ac[V],g:ac[V+1],b:ac[V+2]};N+=ad.r*Y[T+ab*c];sumG+=ad.g*Y[T+ab*c];sumB+=ad.b*Y[T+ab*c]}}var O=I(aa,Z,S)<<2;var U={r:ae[O],g:ae[O+1],b:ae[O+2]};ae=M(ae,O,o(Q,N,U.r),o(Q,sumG,U.g),o(Q,sumB,U.b))}}return(W)}function r(c){var N=0;for(var O=0;O<c.length;O++){N+=c[O]}for(var O=0;O<c.length;O++){c[O]/=N}return c}function I(c,O,N){return c+(O*N)}function F(c){return Math.floor((c>>1)-(Math.random()*c))}function i(c){if(c<0){return 0}else{if(c>255){return 255}else{return c}}}function J(P,N){P.clearRect(0,0,N.width,N.height);if(N.width>0&&N.height>0){try{P.drawImage(N,0,0,N.width,N.height);return(P.getImageData(0,0,P.width,P.height))}catch(O){}}}function n(c){c=c.replace(/^#/,"");if(c.length==3){c=c.replace(/(.)/g,"$1$1")}return(c)}function o(N,c,O){return(N*c+(1-N)*O)}function M(Q,N,P,O,c){Q[N]=P;Q[N+1]=O;Q[N+2]=c;return Q}function x(O){if(O.nodeName=="IMG"){return O}var N=window.getComputedStyle(O,null).backgroundImage;if(N){var c=new Image();c.src=N.replace(/['"]/g,"").slice(4,-1);return c}return false}var w=0;function H(c){return g(b(E(c)))}function d(N,c){return g(m(E(N),E(c)))}function f(){return H("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function b(c){return G(u(a(c),c.length*8))}function m(T,Q){var R=a(T);if(R.length>16){R=u(R,T.length*8)}var O=Array(16),S=Array(16);for(var N=0;N<16;N++){O[N]=R[N]^909522486;S[N]=R[N]^1549556828}var P=u(O.concat(a(Q)),512+Q.length*8);return G(u(S.concat(P),512+128))}function g(S){try{w}catch(P){w=0}var Q=w?"0123456789ABCDEF":"0123456789abcdef";var N="";var O;for(var R=0;R<S.length;R++){O=S.charCodeAt(R);N+=Q.charAt((O>>>4)&15)+Q.charAt(O&15)}return N}function E(R){var N="";var Q=-1;var O,P;while(++Q<R.length){O=R.charCodeAt(Q);P=Q+1<R.length?R.charCodeAt(Q+1):0;if(55296<=O&&O<=56319&&56320<=P&&P<=57343){O=65536+((O&1023)<<10)+(P&1023);Q++}if(O<=127){N+=String.fromCharCode(O)}else{if(O<=2047){N+=String.fromCharCode(192|((O>>>6)&31),128|(O&63))}else{if(O<=65535){N+=String.fromCharCode(224|((O>>>12)&15),128|((O>>>6)&63),128|(O&63))}else{if(O<=2097151){N+=String.fromCharCode(240|((O>>>18)&7),128|((O>>>12)&63),128|((O>>>6)&63),128|(O&63))}}}}}return N}function a(N){var O=Array(N.length>>2);for(var P=0;P<O.length;P++){O[P]=0}for(var P=0;P<N.length*8;P+=8){O[P>>5]|=(N.charCodeAt(P/8)&255)<<(P%32)}return O}function G(N){var O="";for(var P=0;P<N.length*32;P+=8){O+=String.fromCharCode((N[P>>5]>>>(P%32))&255)}return O}function u(c,R){c[R>>5]|=128<<((R)%32);c[(((R+64)>>>9)<<4)+14]=R;var N=1732584193;var O=-271733879;var P=-1732584194;var Q=271733878;for(var U=0;U<c.length;U+=16){var S=N;var T=O;var V=P;var W=Q;N=s(N,O,P,Q,c[U+0],7,-680876936);Q=s(Q,N,O,P,c[U+1],12,-389564586);P=s(P,Q,N,O,c[U+2],17,606105819);O=s(O,P,Q,N,c[U+3],22,-1044525330);N=s(N,O,P,Q,c[U+4],7,-176418897);Q=s(Q,N,O,P,c[U+5],12,1200080426);P=s(P,Q,N,O,c[U+6],17,-1473231341);O=s(O,P,Q,N,c[U+7],22,-45705983);N=s(N,O,P,Q,c[U+8],7,1770035416);Q=s(Q,N,O,P,c[U+9],12,-1958414417);P=s(P,Q,N,O,c[U+10],17,-42063);O=s(O,P,Q,N,c[U+11],22,-1990404162);N=s(N,O,P,Q,c[U+12],7,1804603682);Q=s(Q,N,O,P,c[U+13],12,-40341101);P=s(P,Q,N,O,c[U+14],17,-1502002290);O=s(O,P,Q,N,c[U+15],22,1236535329);N=K(N,O,P,Q,c[U+1],5,-165796510);Q=K(Q,N,O,P,c[U+6],9,-1069501632);P=K(P,Q,N,O,c[U+11],14,643717713);O=K(O,P,Q,N,c[U+0],20,-373897302);N=K(N,O,P,Q,c[U+5],5,-701558691);Q=K(Q,N,O,P,c[U+10],9,38016083);P=K(P,Q,N,O,c[U+15],14,-660478335);O=K(O,P,Q,N,c[U+4],20,-405537848);N=K(N,O,P,Q,c[U+9],5,568446438);Q=K(Q,N,O,P,c[U+14],9,-1019803690);P=K(P,Q,N,O,c[U+3],14,-187363961);O=K(O,P,Q,N,c[U+8],20,1163531501);N=K(N,O,P,Q,c[U+13],5,-1444681467);Q=K(Q,N,O,P,c[U+2],9,-51403784);P=K(P,Q,N,O,c[U+7],14,1735328473);O=K(O,P,Q,N,c[U+12],20,-1926607734);N=B(N,O,P,Q,c[U+5],4,-378558);Q=B(Q,N,O,P,c[U+8],11,-2022574463);P=B(P,Q,N,O,c[U+11],16,1839030562);O=B(O,P,Q,N,c[U+14],23,-35309556);N=B(N,O,P,Q,c[U+1],4,-1530992060);Q=B(Q,N,O,P,c[U+4],11,1272893353);P=B(P,Q,N,O,c[U+7],16,-155497632);O=B(O,P,Q,N,c[U+10],23,-1094730640);N=B(N,O,P,Q,c[U+13],4,681279174);Q=B(Q,N,O,P,c[U+0],11,-358537222);P=B(P,Q,N,O,c[U+3],16,-722521979);O=B(O,P,Q,N,c[U+6],23,76029189);N=B(N,O,P,Q,c[U+9],4,-640364487);Q=B(Q,N,O,P,c[U+12],11,-421815835);P=B(P,Q,N,O,c[U+15],16,530742520);O=B(O,P,Q,N,c[U+2],23,-995338651);N=p(N,O,P,Q,c[U+0],6,-198630844);Q=p(Q,N,O,P,c[U+7],10,1126891415);P=p(P,Q,N,O,c[U+14],15,-1416354905);O=p(O,P,Q,N,c[U+5],21,-57434055);N=p(N,O,P,Q,c[U+12],6,1700485571);Q=p(Q,N,O,P,c[U+3],10,-1894986606);P=p(P,Q,N,O,c[U+10],15,-1051523);O=p(O,P,Q,N,c[U+1],21,-2054922799);N=p(N,O,P,Q,c[U+8],6,1873313359);Q=p(Q,N,O,P,c[U+15],10,-30611744);P=p(P,Q,N,O,c[U+6],15,-1560198380);O=p(O,P,Q,N,c[U+13],21,1309151649);N=p(N,O,P,Q,c[U+4],6,-145523070);Q=p(Q,N,O,P,c[U+11],10,-1120210379);P=p(P,Q,N,O,c[U+2],15,718787259);O=p(O,P,Q,N,c[U+9],21,-343485551);N=t(N,S);O=t(O,T);P=t(P,V);Q=t(Q,W)}return Array(N,O,P,Q)}function k(N,Q,R,S,O,P){return t(e(t(t(Q,N),t(S,P)),O),R)}function s(Q,R,c,N,S,O,P){return k((R&c)|((~R)&N),Q,R,S,O,P)}function K(Q,R,c,N,S,O,P){return k((R&N)|(c&(~N)),Q,R,S,O,P)}function B(Q,R,c,N,S,O,P){return k(R^c^N,Q,R,S,O,P)}function p(Q,R,c,N,S,O,P){return k(c^(R|(~N)),Q,R,S,O,P)}function t(O,P){var Q=(O&65535)+(P&65535);var N=(O>>16)+(P>>16)+(Q>>16);return(N<<16)|(Q&65535)}function e(N,c){return(N<<c)|(N>>>(32-c))}})(jQuery);